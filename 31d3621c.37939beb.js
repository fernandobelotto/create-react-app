(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{113:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return u}));var o=a(0),n=a.n(o);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var b=n.a.createContext({}),l=function(e){var t=n.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},p=function(e){var t=l(e.components);return n.a.createElement(b.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},d=n.a.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,b=i(e,["components","mdxType","originalType","parentName"]),p=l(a),d=o,u=p["".concat(s,".").concat(d)]||p[d]||m[d]||r;return a?n.a.createElement(u,c(c({ref:t},b),{},{components:a})):n.a.createElement(u,c({ref:t},b))}));function u(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=d;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,s[1]=c;for(var b=2;b<r;b++)s[b]=a[b];return n.a.createElement.apply(null,s)}return n.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},71:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return s})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return i})),a.d(t,"default",(function(){return l}));var o=a(2),n=a(6),r=(a(0),a(113)),s={id:"running-tests",title:"Executando testes"},c={unversionedId:"running-tests",id:"running-tests",isDocsHomePage:!1,title:"Executando testes",description:"Nota: este recurso est\xe1 dispon\xedvel com react-scripts@0.3.0 e superior.",source:"@site/..\\docs\\running-tests.md",slug:"/running-tests",permalink:"/create-react-app/docs/running-tests",editUrl:"https://github.com/facebook/create-react-app/edit/master/docusaurus/website/../docs/running-tests.md",version:"current",lastUpdatedBy:"Fernando Belotto",lastUpdatedAt:1609711939,sidebar:"docs",previous:{title:"Criando o build de produ\xe7\xe3o",permalink:"/create-react-app/docs/production-build"},next:{title:"Depurando testes",permalink:"/create-react-app/docs/debugging-tests"}},i=[{value:"Conven\xe7\xf5es de nome de arquivo",id:"conven\xe7\xf5es-de-nome-de-arquivo",children:[]},{value:"Interface da Linha de comando (CLI)",id:"interface-da-linha-de-comando-cli",children:[]},{value:"Integra\xe7\xe3o de controle de vers\xe3o",id:"integra\xe7\xe3o-de-controle-de-vers\xe3o",children:[]},{value:"Escrevendo testes",id:"escrevendo-testes",children:[]},{value:"Testando Componentes",id:"testando-componentes",children:[{value:"React Testing Library",id:"react-testing-library",children:[]}]},{value:"Usando Bibliotecas de Asser\xe7\xe3o de Terceiros",id:"usando-bibliotecas-de-asser\xe7\xe3o-de-terceiros",children:[]},{value:"Inicializando o ambiente de teste",id:"inicializando-o-ambiente-de-teste",children:[{value:"<code>src/setupTests.js</code>",id:"srcsetuptestsjs",children:[]}]},{value:"Focando e Excluindo Testes",id:"focando-e-excluindo-testes",children:[]},{value:"Relat\xf3rio de cobertura",id:"relat\xf3rio-de-cobertura",children:[{value:"Configura\xe7\xe3o",id:"configura\xe7\xe3o",children:[]}]},{value:"Integra\xe7\xe3o cont\xednua",id:"integra\xe7\xe3o-cont\xednua",children:[]},{value:"Em servidores CI",id:"em-servidores-ci",children:[{value:"Travis CI",id:"travis-ci",children:[]},{value:"CircleCI",id:"circleci",children:[]}]},{value:"Em seu pr\xf3prio ambiente",id:"em-seu-pr\xf3prio-ambiente",children:[]},{value:"Desativando jsdom",id:"desativando-jsdom",children:[]},{value:"Teste de Snapshot",id:"teste-de-snapshot",children:[]},{value:"Integra\xe7\xe3o com Editor",id:"integra\xe7\xe3o-com-editor",children:[]}],b={rightToc:i};function l(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(r.b)("wrapper",Object(o.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Nota: este recurso est\xe1 dispon\xedvel com ",Object(r.b)("inlineCode",{parentName:"p"},"react-scripts@0.3.0")," e superior.")),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"Https://github.com/facebook/create-react-app/blob/master/CHANGELOG-0.x.md#migrating-from-023-a-030"}),"Leia o guia de migra\xe7\xe3o para aprender como habilit\xe1-lo em projetos mais antigos!"))),Object(r.b)("p",null,"O Create React App usa ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://jestjs.io/"}),"Jest")," como executor de teste. Para se preparar para essa integra\xe7\xe3o, fizemos uma ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://jestjs.io/blog/2016/09/01/jest-15.html"}),"grande reformula\xe7\xe3o")," do Jest, ent\xe3o, se voc\xea ouviu coisas ruins sobre isso anos atr\xe1s, d\xea outra tentativa."),Object(r.b)("p",null,"Jest \xe9 um runner baseado em Node. Isso significa que os testes sempre s\xe3o executados em um ambiente Node e n\xe3o em um navegador real. Isso nos permite habilitar a velocidade de itera\xe7\xe3o r\xe1pida e evitar falhas."),Object(r.b)("p",null,"Embora Jest forne\xe7a vari\xe1veis globais de navegador, como ",Object(r.b)("inlineCode",{parentName:"p"},"window")," gra\xe7as a ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/tmpvar/jsdom"}),"jsdom"),", eles s\xe3o apenas aproxima\xe7\xf5es do comportamento real do navegador. Jest se destina a ser usado para testes unit\xe1rios de sua l\xf3gica e seus componentes, em vez de peculiaridades do DOM."),Object(r.b)("p",null,"Recomendamos que voc\xea use uma ferramenta separada para testes de ponta a ponta do navegador, se necess\xe1rio. Eles est\xe3o al\xe9m do escopo do Create React App."),Object(r.b)("h2",{id:"conven\xe7\xf5es-de-nome-de-arquivo"},"Conven\xe7\xf5es de nome de arquivo"),Object(r.b)("p",null,"Jest procurar\xe1 arquivos de teste com qualquer uma das seguintes conven\xe7\xf5es de nomenclatura populares:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Arquivos com sufixo ",Object(r.b)("inlineCode",{parentName:"li"},".js")," em pastas ",Object(r.b)("inlineCode",{parentName:"li"},"__tests__"),"."),Object(r.b)("li",{parentName:"ul"},"Arquivos com sufixo ",Object(r.b)("inlineCode",{parentName:"li"},".test.js"),"."),Object(r.b)("li",{parentName:"ul"},"Arquivos com sufixo ",Object(r.b)("inlineCode",{parentName:"li"},".spec.js"),".")),Object(r.b)("p",null,"Os arquivos ",Object(r.b)("inlineCode",{parentName:"p"},".test.js")," / ",Object(r.b)("inlineCode",{parentName:"p"},".spec.js")," (ou as pastas ",Object(r.b)("inlineCode",{parentName:"p"},"__tests__"),") podem ser localizados em qualquer profundidade na pasta ",Object(r.b)("inlineCode",{parentName:"p"},"src"),"."),Object(r.b)("p",null,"Recomendamos colocar os arquivos de teste (ou pastas ",Object(r.b)("inlineCode",{parentName:"p"},"__tests__"),") ao lado do c\xf3digo que eles est\xe3o testando para que as importa\xe7\xf5es relativas pare\xe7am menores. Por exemplo, se ",Object(r.b)("inlineCode",{parentName:"p"},"App.test.js")," e ",Object(r.b)("inlineCode",{parentName:"p"},"App.js")," est\xe3o na mesma pasta, o teste s\xf3 precisa ",Object(r.b)("inlineCode",{parentName:"p"},"importar App de './App'")," em vez de um longo caminho relativo. A coloca\xe7\xe3o tamb\xe9m ajuda a encontrar testes mais rapidamente em projetos maiores."),Object(r.b)("h2",{id:"interface-da-linha-de-comando-cli"},"Interface da Linha de comando (CLI)"),Object(r.b)("p",null,"Ao executar o ",Object(r.b)("inlineCode",{parentName:"p"},"npm test"),", o Jest ser\xe1 iniciado no modo de observa\xe7\xe3o ",Object(r.b)("sup",null,"*"),". Cada vez que voc\xea salva um arquivo, ele ir\xe1 reexecutar os testes, como ",Object(r.b)("inlineCode",{parentName:"p"},"npm start")," recompila o c\xf3digo."),Object(r.b)("p",null,'O watcher inclui uma interface de linha de comando interativa com a capacidade de executar todos os testes ou focar em um padr\xe3o de pesquisa. Ele foi projetado dessa forma para que voc\xea possa mant\xea-lo aberto e desfrutar de novas execu\xe7\xf5es r\xe1pidas. Voc\xea pode aprender os comandos da nota "Observar uso" que o observador imprime ap\xf3s cada execu\xe7\xe3o:'),Object(r.b)("p",null,Object(r.b)("img",Object(o.a)({parentName:"p"},{src:"https://jestjs.io/img/blog/15-watch.gif",alt:"Jest watch mode"}))),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"*","Embora recomendemos executar seus testes no modo de observa\xe7\xe3o durante o desenvolvimento, voc\xea pode desabilitar este comportamento passando o sinalizador ",Object(r.b)("inlineCode",{parentName:"p"},"--watchAll=false"),". Na maioria dos ambientes de CI, isso \xe9 feito para voc\xea (consulte ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"#em-servidores-ci"}),"Em servidores de CI"),").")),Object(r.b)("h2",{id:"integra\xe7\xe3o-de-controle-de-vers\xe3o"},"Integra\xe7\xe3o de controle de vers\xe3o"),Object(r.b)("p",null,"Por padr\xe3o, quando voc\xea executa o ",Object(r.b)("inlineCode",{parentName:"p"},"npm test"),", o Jest s\xf3 executa os testes relacionados aos arquivos alterados desde o \xfaltimo commit. Esta \xe9 uma otimiza\xe7\xe3o projetada para fazer seus testes serem executados mais rapidamente, independentemente de quantos testes voc\xea tenha. No entanto, presume que voc\xea n\xe3o costuma enviar o c\xf3digo que n\xe3o passa nos testes."),Object(r.b)("p",null,"Jest sempre mencionar\xe1 explicitamente que s\xf3 executou testes relacionados aos arquivos alterados desde o \xfaltimo commit. Voc\xea tamb\xe9m pode pressionar ",Object(r.b)("inlineCode",{parentName:"p"},"a")," no modo de observa\xe7\xe3o para for\xe7ar Jest a executar todos os testes."),Object(r.b)("p",null,"O Jest sempre executar\xe1 todos os testes em um servidor de ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"#integra%C3%A7%C3%A3oicont%C3%ADnua"}),"integra\xe7\xe3o cont\xednua")," ou se o projeto n\xe3o estiver dentro de um reposit\xf3rio Git ou Mercurial."),Object(r.b)("h2",{id:"escrevendo-testes"},"Escrevendo testes"),Object(r.b)("p",null,"Para criar testes, adicione os blocos ",Object(r.b)("inlineCode",{parentName:"p"},"it()")," (ou ",Object(r.b)("inlineCode",{parentName:"p"},"test()"),") com o nome do teste e seu c\xf3digo. Voc\xea pode opcionalmente envolv\xea-los em blocos ",Object(r.b)("inlineCode",{parentName:"p"},"describe()")," para agrupamento l\xf3gico, mas isso n\xe3o \xe9 necess\xe1rio nem recomendado."),Object(r.b)("p",null,"Jest fornece uma fun\xe7\xe3o global ",Object(r.b)("inlineCode",{parentName:"p"},"expect()")," embutida para fazer asser\xe7\xf5es. Um teste b\xe1sico pode ser assim:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"import sum from './sum';\n\nit('sums numbers', () => {\n  expect(sum(1, 2)).toEqual(3);\n  expect(sum(2, 2)).toEqual(4);\n});\n")),Object(r.b)("p",null,"Todos os matchers ",Object(r.b)("inlineCode",{parentName:"p"},"expect()")," suportados pelo Jest s\xe3o ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://jestjs.io/docs/en/expect.html#content"}),"amplamente documentados aqui"),"."),Object(r.b)("p",null,"Voc\xea tamb\xe9m pode usar ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://jestjs.io/docs/en/expect.html#tohavebeencalled"}),Object(r.b)("inlineCode",{parentName:"a"},"jest.fn()")," e ",Object(r.b)("inlineCode",{parentName:"a"},"expect(fn).toBeCalled()"))," para criar \u201cespi\xf5es\u201d ou simula\xe7\xe3o fun\xe7\xf5es."),Object(r.b)("h2",{id:"testando-componentes"},"Testando Componentes"),Object(r.b)("p",null,"Existe um amplo espectro de t\xe9cnicas de teste de componentes. Eles variam de um \u201cteste de fuma\xe7a\u201d verificando se um componente \xe9 renderizado sem lan\xe7ar, para renderiza\xe7\xe3o superficial e testar algumas das sa\xeddas, para renderiza\xe7\xe3o completa e testar o ciclo de vida do componente e mudan\xe7as de estado."),Object(r.b)("p",null,"Diferentes projetos escolhem diferentes compensa\xe7\xf5es de teste com base na frequ\xeancia de altera\xe7\xe3o dos componentes e na quantidade de l\xf3gica que eles cont\xeam. Se voc\xea ainda n\xe3o decidiu uma estrat\xe9gia de teste, recomendamos que comece criando testes b\xe1sicos de fuma\xe7a para seus componentes:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nit('renders without crashing', () => {\n  const div = document.createElement('div');\n  ReactDOM.render(<App />, div);\n});\n")),Object(r.b)("p",null,"Este teste monta um componente e certifica-se de que ele n\xe3o foi lan\xe7ado durante a renderiza\xe7\xe3o. Testes como esse fornecem muito valor com muito pouco esfor\xe7o, portanto, s\xe3o \xf3timos como ponto de partida, e este \xe9 o teste que voc\xea encontrar\xe1 em ",Object(r.b)("inlineCode",{parentName:"p"},"src/App.test.js"),"."),Object(r.b)("p",null,"Ao encontrar bugs causados \u200b\u200bpela altera\xe7\xe3o de componentes, voc\xea obter\xe1 um insight mais profundo sobre quais partes deles vale a pena testar em seu aplicativo. Este pode ser um bom momento para introduzir testes mais espec\xedficos, afirmando resultados ou comportamentos esperados espec\xedficos."),Object(r.b)("h3",{id:"react-testing-library"},"React Testing Library"),Object(r.b)("p",null,"Se voc\xea deseja testar componentes isolados dos componentes filhos que eles renderizam, recomendamos o uso de ",Object(r.b)("inlineCode",{parentName:"p"},"react-testing-library"),". ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/testing-library/react-testing-library"}),Object(r.b)("inlineCode",{parentName:"a"},"react-testing-library"))," \xe9 uma biblioteca para testar componentes React de uma forma que se assemelha \xe0 forma como os componentes s\xe3o usados \u200b\u200bpelos usu\xe1rios finais. Ele \xe9 adequado para testes unit\xe1rios, integra\xe7\xe3o e ponta a ponta de componentes e aplicativos React. Ele funciona mais diretamente com n\xf3s DOM e, portanto, \xe9 recomendado usar com ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/testing-library/jest-dom"}),Object(r.b)("inlineCode",{parentName:"a"},"jest-dom"))," para asser\xe7\xf5es aprimoradas."),Object(r.b)("p",null,"Para instalar ",Object(r.b)("inlineCode",{parentName:"p"},"react-testing-library")," e ",Object(r.b)("inlineCode",{parentName:"p"},"jest-dom"),", voc\xea pode executar:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"npm install --save @testing-library/react @testing-library/jest-dom\n")),Object(r.b)("p",null,"Alternativamente, voc\xea pode usar ",Object(r.b)("inlineCode",{parentName:"p"},"yarn"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"yarn add @testing-library/react @testing-library/jest-dom\n")),Object(r.b)("p",null,"If you want to avoid boilerplate in your test files, you can create a ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"#initializing-test-environment"}),Object(r.b)("inlineCode",{parentName:"a"},"src/setupTests.js"))," file:\nSe voc\xea quiser evitar boilerplate em seus arquivos de teste, voc\xea pode criar um arquivo ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"#iniciando-o-ambiente-de-testes"}),Object(r.b)("inlineCode",{parentName:"a"},"src/setupTests.js")),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"// react-testing-library renderiza seus componentes para document.body,\n// isto adiciona asser\xe7\xf5es personalizadas de jest-dom\nimport '@testing-library/jest-dom';\n")),Object(r.b)("p",null,"Aqui est\xe1 um exemplo do uso de ",Object(r.b)("inlineCode",{parentName:"p"},"react-testing-library")," e ",Object(r.b)("inlineCode",{parentName:"p"},"jest-dom")," para testar se o componente ",Object(r.b)("inlineCode",{parentName:"p"},"<App />"),' renderiza "Learn React".'),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"import React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport App from './App';\n\nit('renders welcome message', () => {\n  render(<App />);\n  expect(screen.getByText('Learn React')).toBeInTheDocument();\n});\n")),Object(r.b)("p",null,"Saiba mais sobre os utilit\xe1rios fornecidos pela ",Object(r.b)("inlineCode",{parentName:"p"},"react-testing-library")," para facilitar o teste de intera\xe7\xf5es ass\xedncronas, bem como a sele\xe7\xe3o de elementos de formul\xe1rio da ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://testing-library.com/react"}),"documenta\xe7\xe3o da ",Object(r.b)("inlineCode",{parentName:"a"},"react-testing-library"))," e ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://codesandbox.io/s/github/kentcdodds/react-testing-library-examples"}),"exemplos"),"."),Object(r.b)("h2",{id:"usando-bibliotecas-de-asser\xe7\xe3o-de-terceiros"},"Usando Bibliotecas de Asser\xe7\xe3o de Terceiros"),Object(r.b)("p",null,"We recommend that you use ",Object(r.b)("inlineCode",{parentName:"p"},"expect()")," for assertions and ",Object(r.b)("inlineCode",{parentName:"p"},"jest.fn()")," for spies. If you are having issues with them please ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/facebook/jest/issues/new"}),"file those against Jest"),", and we\u2019ll fix them. We intend to keep making them better for React, supporting, for example, ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/facebook/jest/pull/1566"}),"pretty-printing React elements as JSX"),".\nRecomendamos que voc\xea use ",Object(r.b)("inlineCode",{parentName:"p"},"expect()")," para asser\xe7\xf5es e ",Object(r.b)("inlineCode",{parentName:"p"},"jest.fn()")," para espi\xf5es. Se voc\xea estiver tendo problemas com eles, ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/facebook/jest/issues/new"}),"arquive-os contra Jest")," e n\xf3s os corrigiremos. Pretendemos continuar a torn\xe1-los melhores para o React, suportando, por exemplo, ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/facebook/jest/pull/1566"}),"elementos do React pretty-printing como JSX"),"."),Object(r.b)("p",null,"No entanto, se voc\xea estiver acostumado com outras bibliotecas, como ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://www.chaijs.com/"}),"Chai")," e ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://sinonjs.org/"}),"Sinon"),", ou se j\xe1 houver c\xf3digo usando-as que voc\xea gostaria de transferir, voc\xea pode import\xe1-los normalmente desta forma:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"import sinon from 'sinon';\nimport { expect } from 'chai';\n")),Object(r.b)("p",null,"e, em seguida, use-os em seus testes como voc\xea faz normalmente."),Object(r.b)("h2",{id:"inicializando-o-ambiente-de-teste"},"Inicializando o ambiente de teste"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Nota: este recurso est\xe1 dispon\xedvel com ",Object(r.b)("inlineCode",{parentName:"p"},"react-scripts@0.4.0")," e superior.")),Object(r.b)("p",null,"Se seu aplicativo usa uma API de navegador que voc\xea precisa simular em seus testes ou se voc\xea precisa de uma configura\xe7\xe3o global antes de executar seus testes, adicione ",Object(r.b)("inlineCode",{parentName:"p"},"src/setupTests.js")," ao seu projeto. Ele ser\xe1 executado automaticamente antes de executar seus testes."),Object(r.b)("p",null,"Por exemplo:"),Object(r.b)("h3",{id:"srcsetuptestsjs"},Object(r.b)("inlineCode",{parentName:"h3"},"src/setupTests.js")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),"const localStorageMock = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n};\nglobal.localStorage = localStorageMock;\n")),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},'Nota: Tenha em mente que se voc\xea decidir "ejetar" antes de criar ',Object(r.b)("inlineCode",{parentName:"p"},"src/setupTests.js"),", o arquivo ",Object(r.b)("inlineCode",{parentName:"p"},"package.json")," resultante n\xe3o conter\xe1 nenhuma refer\xeancia a ele, ent\xe3o voc\xea deve criar manualmente a propriedade ",Object(r.b)("inlineCode",{parentName:"p"},"setupFilesAfterEnv")," na configura\xe7\xe3o do Jest, algo como o seguinte:")),Object(r.b)("blockquote",null,Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),'"jest": {\n  // ...\n  "setupFilesAfterEnv": ["<rootDir>/src/setupTests.js"]\n }\n'))),Object(r.b)("h2",{id:"focando-e-excluindo-testes"},"Focando e Excluindo Testes"),Object(r.b)("p",null,"Voc\xea pode substituir ",Object(r.b)("inlineCode",{parentName:"p"},"it()")," por ",Object(r.b)("inlineCode",{parentName:"p"},"xit()")," para excluir temporariamente a execu\xe7\xe3o de um teste."),Object(r.b)("p",null,"Da mesma forma, ",Object(r.b)("inlineCode",{parentName:"p"},"fit()")," permite que voc\xea se concentre em um teste espec\xedfico sem executar nenhum outro teste."),Object(r.b)("h2",{id:"relat\xf3rio-de-cobertura"},"Relat\xf3rio de cobertura"),Object(r.b)("p",null,"Jest tem um relator de cobertura integrado que funciona bem com ES6 e n\xe3o requer configura\xe7\xe3o."),Object(r.b)("p",null,"Execute ",Object(r.b)("inlineCode",{parentName:"p"},"npm test -- --coverage")," (observe o extra ",Object(r.b)("inlineCode",{parentName:"p"},"--")," no meio) para incluir um relat\xf3rio de cobertura como este:"),Object(r.b)("p",null,Object(r.b)("img",Object(o.a)({parentName:"p"},{src:"https://i.imgur.com/5bFhnTS.png",alt:"coverage report"}))),Object(r.b)("p",null,"Observe que os testes s\xe3o executados muito mais lentamente com cobertura, portanto, \xe9 recomend\xe1vel execut\xe1-los separadamente do fluxo de trabalho normal."),Object(r.b)("h3",{id:"configura\xe7\xe3o"},"Configura\xe7\xe3o"),Object(r.b)("p",null,"A configura\xe7\xe3o de cobertura Jest padr\xe3o pode ser substitu\xedda adicionando qualquer uma das seguintes chaves suportadas a uma configura\xe7\xe3o Jest em seu package.json."),Object(r.b)("p",null,"Substitui\xe7\xf5es suportadas:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#clearmocks-boolean"}),Object(r.b)("inlineCode",{parentName:"a"},"clearMocks"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#collectcoveragefrom-array"}),Object(r.b)("inlineCode",{parentName:"a"},"collectCoverageFrom"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#coveragereporters-array-string"}),Object(r.b)("inlineCode",{parentName:"a"},"coverageReporters"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#coveragethreshold-object"}),Object(r.b)("inlineCode",{parentName:"a"},"coverageThreshold"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#displayname-string-object"}),Object(r.b)("inlineCode",{parentName:"a"},"displayName"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#extraglobals-array-string"}),Object(r.b)("inlineCode",{parentName:"a"},"extraGlobals"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#globalsetup-string"}),Object(r.b)("inlineCode",{parentName:"a"},"globalSetup"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#globalteardown-string"}),Object(r.b)("inlineCode",{parentName:"a"},"globalTeardown"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#modulenamemapper-object-string-string"}),Object(r.b)("inlineCode",{parentName:"a"},"moduleNameMapper"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#resetmocks-boolean"}),Object(r.b)("inlineCode",{parentName:"a"},"resetMocks"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#resetmodules-boolean"}),Object(r.b)("inlineCode",{parentName:"a"},"resetModules"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#snapshotserializers-array-string"}),Object(r.b)("inlineCode",{parentName:"a"},"snapshotSerializers"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#transform-object-string-pathtotransformer-pathtotransformer-object"}),Object(r.b)("inlineCode",{parentName:"a"},"transform"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#transformignorepatterns-array-string"}),Object(r.b)("inlineCode",{parentName:"a"},"transformIgnorePatterns"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://jestjs.io/docs/en/configuration.html#watchpathignorepatterns-array-string"}),Object(r.b)("inlineCode",{parentName:"a"},"watchPathIgnorePatterns")))),Object(r.b)("p",null,"Exemplo package.json:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n  "name": "your-package",\n  "jest": {\n    "collectCoverageFrom": [\n      "src/**/*.{js,jsx,ts,tsx}",\n      "!<rootDir>/node_modules/",\n      "!<rootDir>/path/to/dir/"\n    ],\n    "coverageThreshold": {\n      "global": {\n        "branches": 90,\n        "functions": 90,\n        "lines": 90,\n        "statements": 90\n      }\n    },\n    "coverageReporters": ["text"],\n    "snapshotSerializers": ["my-serializer-module"]\n  }\n}\n')),Object(r.b)("h2",{id:"integra\xe7\xe3o-cont\xednua"},"Integra\xe7\xe3o cont\xednua"),Object(r.b)("p",null,"Por padr\xe3o, o ",Object(r.b)("inlineCode",{parentName:"p"},"npm test")," executa o observador com CLI interativa. No entanto, voc\xea pode for\xe7\xe1-lo a executar testes uma vez e concluir o processo definindo uma vari\xe1vel de ambiente chamada ",Object(r.b)("inlineCode",{parentName:"p"},"CI"),"."),Object(r.b)("p",null,"Ao criar uma vers\xe3o do seu aplicativo com ",Object(r.b)("inlineCode",{parentName:"p"},"npm run build"),", os avisos do linter n\xe3o s\xe3o verificados por padr\xe3o. Como o ",Object(r.b)("inlineCode",{parentName:"p"},"npm test"),", voc\xea pode for\xe7ar a constru\xe7\xe3o a executar uma verifica\xe7\xe3o de aviso do linter definindo a vari\xe1vel de ambiente ",Object(r.b)("inlineCode",{parentName:"p"},"CI"),". Se algum aviso for encontrado, a constru\xe7\xe3o falhar\xe1."),Object(r.b)("p",null,"Servidores CI populares j\xe1 definem a vari\xe1vel de ambiente ",Object(r.b)("inlineCode",{parentName:"p"},"CI")," por padr\xe3o, mas voc\xea tamb\xe9m pode fazer isso:"),Object(r.b)("h2",{id:"em-servidores-ci"},"Em servidores CI"),Object(r.b)("h3",{id:"travis-ci"},"Travis CI"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Seguindo o guia ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://docs.travis-ci.com/user/getting-started/"}),"Travis Getting started")," para sincronizar seu reposit\xf3rio GitHub com Travis. Pode ser necess\xe1rio inicializar algumas configura\xe7\xf5es manualmente em sua p\xe1gina ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://travis-ci.org/profile"}),"perfil"),"."),Object(r.b)("li",{parentName:"ol"},"Adicione um arquivo ",Object(r.b)("inlineCode",{parentName:"li"},".travis.yml")," ao seu reposit\xf3rio git.")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-yaml"}),"language: node_js\nnode_js:\n  - 8\ncache:\n  directories:\n    - node_modules\nscript:\n  - npm run build\n  - npm test\n")),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Acione sua primeira build com um push git."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://docs.travis-ci.com/user/customizing-the-build/"}),"Personalize seu Travis CI Build")," se necess\xe1rio.")),Object(r.b)("h3",{id:"circleci"},"CircleCI"),Object(r.b)("p",null,"Siga ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://medium.com/@knowbody/circleci-and-zeits-now-sh-c9b7eebcd3c1"}),"este artigo")," para configurar o CircleCI com um projeto Create React App."),Object(r.b)("h2",{id:"em-seu-pr\xf3prio-ambiente"},"Em seu pr\xf3prio ambiente"),Object(r.b)("h4",{id:"windows-cmdexe"},"Windows (cmd.exe)"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-cmd"}),"set CI=true&&npm test\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-cmd"}),"set CI=true&&npm run build\n")),Object(r.b)("p",null,"(Observa\xe7\xe3o: a falta de espa\xe7o em branco \xe9 intencional.)"),Object(r.b)("h4",{id:"windows-powershell"},"Windows (Powershell)"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-Powershell"}),'($env:CI = "true") -and (npm test)\n')),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-Powershell"}),'($env:CI = "true") -and (npm run build)\n')),Object(r.b)("h4",{id:"linux-macos-bash"},"Linux, macOS (Bash)"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"CI=true npm test\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"CI=true npm run build\n")),Object(r.b)("p",null,"O comando de teste for\xe7ar\xe1 Jest a ser executado no modo CI e os testes ser\xe3o executados apenas uma vez, em vez de iniciar o inspetor."),Object(r.b)("p",null,"Para ambientes n\xe3o CI, voc\xea pode passar o sinalizador ",Object(r.b)("inlineCode",{parentName:"p"},"--watchAll=false")," para desativar a observa\xe7\xe3o de teste."),Object(r.b)("p",null,"O comando build verificar\xe1 se h\xe1 avisos do linter e falhar\xe1 se algum for encontrado."),Object(r.b)("h2",{id:"desativando-jsdom"},"Desativando jsdom"),Object(r.b)("p",null,"Se voc\xea sabe que nenhum de seus testes depende de ","[jsdom]"," (",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/tmpvar/jsdom"}),"https://github.com/tmpvar/jsdom"),"), voc\xea pode definir com seguran\xe7a ",Object(r.b)("inlineCode",{parentName:"p"},"--env = node"),", e seus testes ser\xe3o executados mais rapidamente:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-diff"}),'  "scripts": {\n    "start": "react-scripts start",\n    "build": "react-scripts build",\n-   "test": "react-scripts test"\n+   "test": "react-scripts test --env=node"\n')),Object(r.b)("p",null,"Para ajud\xe1-lo a se decidir, aqui est\xe1 uma lista de APIs que ",Object(r.b)("strong",{parentName:"p"},"precisam do jsdom"),":"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Qualquer vari\xe1vel global do navegador, como ",Object(r.b)("inlineCode",{parentName:"li"},"window")," e",Object(r.b)("inlineCode",{parentName:"li"}," document")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://facebook.github.io/react/docs/top-level-api.html#reactdom.render"}),Object(r.b)("inlineCode",{parentName:"a"},"ReactDOM.render()"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://facebook.github.io/react/docs/test-utils.html#renderintodocument"}),Object(r.b)("inlineCode",{parentName:"a"},"TestUtils.renderIntoDocument()"))," (",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://github.com/facebook/react/blob/34761cf9a252964abfaab6faf74d473ad95d1f21/src/test/ReactTestUtils.js#L83-L91"}),"a shortcut")," for the above)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://airbnb.io/enzyme/docs/api/mount.html"}),Object(r.b)("inlineCode",{parentName:"a"},"mount()"))," in ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://airbnb.io/enzyme/index.html"}),"Enzyme")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://testing-library.com/docs/react-testing-library/api/#render"}),Object(r.b)("inlineCode",{parentName:"a"},"render()"))," in ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://testing-library.com/docs/react-testing-library/intro/"}),"React Testing Library"))),Object(r.b)("p",null,"Em contraste, ",Object(r.b)("strong",{parentName:"p"},"jsdom n\xe3o \xe9 necess\xe1rio")," para as seguintes APIs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://facebook.github.io/react/docs/test-utils.html#shallow-rendering"}),Object(r.b)("inlineCode",{parentName:"a"},"TestUtils.createRenderer()"))," (shallow rendering)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://airbnb.io/enzyme/docs/api/shallow.html"}),Object(r.b)("inlineCode",{parentName:"a"},"shallow()"))," in ",Object(r.b)("a",Object(o.a)({parentName:"li"},{href:"https://airbnb.io/enzyme/index.html"}),"Enzyme"))),Object(r.b)("p",null,"Por fim, jsdom tamb\xe9m n\xe3o \xe9 necess\xe1rio para ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://jestjs.io/blog/2016/07/27/jest-14.html"}),"teste de snapshot"),"."),Object(r.b)("h2",{id:"teste-de-snapshot"},"Teste de Snapshot"),Object(r.b)("p",null,"O teste de snapshot \xe9 um recurso do Jest que gera automaticamente snapshots de texto de seus componentes e os salva no disco para que, se a sa\xedda da UI mudar, voc\xea seja notificado sem escrever manualmente nenhuma asser\xe7\xe3o na sa\xedda do componente. ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"Https://jestjs.io/blog/2016/07/27/jest-14.html"}),"Leia mais sobre o teste de snapshots.")),Object(r.b)("h2",{id:"integra\xe7\xe3o-com-editor"},"Integra\xe7\xe3o com Editor"),Object(r.b)("p",null,"Se voc\xea usar ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://code.visualstudio.com"}),"Visual Studio Code"),", h\xe1 uma ",Object(r.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/orta/vscode-jest"}),"extens\xe3o para Jest")," que funciona com Create React App fora direta para uso. Isso fornece muitos recursos do tipo IDE ao usar um editor de texto: mostrar o status de uma execu\xe7\xe3o de teste com mensagens de falha em potencial, iniciar e parar o inspetor automaticamente e oferecer atualiza\xe7\xf5es instant\xe2neas com um clique."),Object(r.b)("p",null,Object(r.b)("img",Object(o.a)({parentName:"p"},{src:"https://cloud.githubusercontent.com/assets/49038/20795349/a032308a-b7c8-11e6-9b34-7eeac781003f.png",alt:"VS Code Jest Preview"}))))}l.isMDXComponent=!0}}]);